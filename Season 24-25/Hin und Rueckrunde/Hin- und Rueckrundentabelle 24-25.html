<!DOCTYPE html>
<html>
  <head>
    <title>Hin- und Rückrundentabelle 24-25</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <h1>Hin- und Rückrundentabelle 24-25</h1>
    <div id="tables"></div>

    <script>
      const pointsAfter17 = {
        Espen: 1170,
        Phil: 960,
        Emil: 954,
        Erwin: 898,
        Kempka: 880,
        Markus: 788,
        Steffen: 761,
        Eirik: 726,
        Basti: 725,
        Didi: 504
      };

      const pointsAfter34 = {
        Espen: 1929,
        Phil: 1650,
        Emil: 1747,
        Erwin: 1765,
        Kempka: 1583,
        Markus: 1626,
        Steffen: 1342,
        Eirik: 1443,
        Basti: 1401,
        Didi: 1124
      };

      function toArray(obj) {
        return Object.entries(obj).map(([name, points]) => ({ name, points }));
      }

      function calculateRueckrunde(after17, after34) {
        const result = [];
        for (const name in after17) {
          if (after34[name] !== undefined) {
            result.push({
              name,
              points: after34[name] - after17[name]
            });
          }
        }
        return result;
      }

      function renderTable(data, title, highlightTop = false) {
        const sorted = [...data].sort((a, b) => b.points - a.points);
        const topScore = sorted.length > 0 ? sorted[0].points : null;

        let html = `
          <div style="margin-bottom: 2rem;">
            <h2 style="font-size: 1.25rem; font-weight: bold; margin-bottom: 1rem;">${title}</h2>
            <table style="width: 100%; border-collapse: collapse; text-align: left;">
              <thead>
                <tr style="border-bottom: 2px solid #ccc;">
                  <th style="padding: 0.5rem;">Place</th>
                  <th style="padding: 0.5rem;">Name</th>
                  <th style="padding: 0.5rem;">Points</th>
                </tr>
              </thead>
              <tbody>
        `;

        sorted.forEach((entry, i) => {
          const highlight =
            highlightTop && entry.points === topScore
              ? ' style="background-color: #fff9c4; font-weight: bold;"'
              : "";
          html += `
            <tr${highlight}>
              <td style="padding: 0.5rem;">${i + 1}</td>
              <td style="padding: 0.5rem;">${entry.name}</td>
              <td style="padding: 0.5rem;">${entry.points}</td>
            </tr>
          `;
        });

        html += `</tbody></table></div>`;
        return html;
      }

      document.addEventListener("DOMContentLoaded", () => {
        const hinrunde = toArray(pointsAfter17);
        const rueckrunde = calculateRueckrunde(pointsAfter17, pointsAfter34);
        document.getElementById("tables").innerHTML =
          renderTable(hinrunde, "Hinrunde Tabelle") +
          renderTable(rueckrunde, "Rückrunde Tabelle", true);
      });
    </script>
  </body>
</html>
