<!DOCTYPE html>
<html>
  <head>
    <title>Hin- und Rückrundentabelle 24-25</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <h1>Hin- und Rückrundentabelle 24-25</h1>
    <div id="tables"></div>

    <script>
      const pointsAfter17 = {
        Espen: 1170,
        Phil: 960,
        Emil: 954,
        Erwin: 898,
        Kempka: 880,
        Markus: 788,
        Steffen: 761,
        Eirik: 726,
        Basti: 725,
        Didi: 504
      };

      const pointsAfter34 = {
        Espen: 1989,
        Phil: 1699,
        Emil: 1806,
        Erwin: 1815,
        Kempka: 1672,
        Markus: 1673,
        Steffen: 1384,
        Eirik: 1517,
        Basti: 1438,
        Didi: 1167
      };

      function toArray(obj) {
        return Object.entries(obj).map(([name, points]) => ({ name, points }));
      }

      function calculateRueckrunde(after17, after34) {
        const result = [];
        for (const name in after17) {
          if (after34[name] !== undefined) {
            const hin = after17[name];
            const rueck = after34[name] - hin;
            result.push({
              name,
              rueckrunde: rueck,
              hinrunde: hin,
              diff: rueck - hin
            });
          }
        }
        return result;
      }

      function renderTable(data, title, type = "hinrunde") {
        let html = `
          <div style="margin-bottom: 2rem;">
            <h2 style="font-size: 1.25rem; font-weight: bold; margin-bottom: 1rem;">${title}</h2>
            <table style="width: 100%; border-collapse: collapse; text-align: left;">
              <thead>
                <tr style="border-bottom: 2px solid #ccc;">
                  <th style="padding: 0.5rem;">Place</th>
                  <th style="padding: 0.5rem;">Name</th>
                  <th style="padding: 0.5rem;">Points</th>
                  <th style="padding: 0.5rem;">Hinrunde</th>
                  <th style="padding: 0.5rem;">Veränderung</th>
                </tr>
              </thead>
              <tbody>
        `;

        const sorted =
          type === "hinrunde"
            ? [...data].sort((a, b) => b.points - a.points)
            : [...data].sort((a, b) => b.rueckrunde - a.rueckrunde);

        sorted.forEach((entry, i) => {
          let name = entry.name;
          let row;

          if (type === "hinrunde") {
            row = `
              <td style="padding: 0.5rem;">${i + 1}</td>
              <td style="padding: 0.5rem;">${name}</td>
              <td style="padding: 0.5rem;">${entry.points}</td>
              <td style="padding: 0.5rem;">–</td>
              <td style="padding: 0.5rem;">–</td>
            `;
          } else {
            let diffText =
              entry.diff > 0
                ? `<span style="color: green;">+${entry.diff}</span>`
                : entry.diff < 0
                ? `<span style="color: red;">${entry.diff}</span>`
                : "0";

            row = `
              <td style="padding: 0.5rem;">${i + 1}</td>
              <td style="padding: 0.5rem;">${name}</td>
              <td style="padding: 0.5rem;">${entry.rueckrunde}</td>
              <td style="padding: 0.5rem;">${entry.hinrunde}</td>
              <td style="padding: 0.5rem;">${diffText}</td>
            `;
          }

          html += `<tr>${row}</tr>`;
        });

        html += `</tbody></table></div>`;
        return html;
      }

      document.addEventListener("DOMContentLoaded", () => {
        const hinrunde = toArray(pointsAfter17);
        const rueckrunde = calculateRueckrunde(pointsAfter17, pointsAfter34);

        document.getElementById("tables").innerHTML =
          renderTable(hinrunde, "Hinrunde Tabelle", "hinrunde") +
          renderTable(rueckrunde, "Rückrunde Tabelle (inkl. Veränderung)", "rueckrunde");
      });
    </script>
  </body>
</html>
